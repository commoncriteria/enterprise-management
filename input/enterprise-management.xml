<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../transforms/module/module2html.xsl"?>
<?xml-model href="../transforms/schemas/CCModule.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>

<Module  boilerplate='yes'
    target-product="Enterprise-Management"
    name="PP-Module for Enterprise-Management"
    xmlns="https://niap-ccevs.org/cc/v1"
    xmlns:cc="https://niap-ccevs.org/cc/v1"
    xmlns:sec="https://niap-ccevs.org/cc/v1/section"
    xmlns:h="http://www.w3.org/1999/xhtml">

  <!-- <comment color='green'> Hello World QQQQ </comment> -->
  <!-- <comment color='blue' linebreak='yes'> Hello World QQQQ </comment> -->
  <PPReference>
    <ReferenceTable>
      <PPVersion>2.0</PPVersion>
      <PPAuthor>National Information Assurance Partnership</PPAuthor>
      <PPPubDate>2025-07-18</PPPubDate>
      <Keywords/>
    </ReferenceTable>
  </PPReference>

  <RevisionHistory>
    <entry>
      <version>2.0</version>
      <date>2025-07-18</date>
      <subject>Initial draft (version numbering chosen for alignment with the ESM family of modules)</subject>
    </entry>
  </RevisionHistory>


  <include-pkg id="pkg-ssh">
    <git>
      <url>https://github.com/commoncriteria/ssh</url>
      <branch>release-2.0</branch>
    </git>
    <url>https://www.niap-ccevs.org/protectionprofiles/515</url>
    <depends on-sel="sel_all_ssh"/>
  </include-pkg>
  <include-pkg id="pkg-tls">
    <git>
      <url>https://github.com/commoncriteria/tls</url>
      <branch>release-2.1</branch>
    </git>
    <url>https://www.niap-ccevs.org/Profile/Info.cfm?PPID=439&amp;id=439</url>
  </include-pkg>
  <include-pkg id="pkg-x509">
    <git>
      <url>https://github.com/commoncriteria/x509</url>
      <branch>release-1.0</branch>
    </git>
    <url>https://www.niap-ccevs.org/protectionprofiles/511</url>
  </include-pkg>
  <include-pkg id="pkg-vpnc">
    <git>
      <url>https://github.com/commoncriteria/vpnclient</url>
      <branch>release-3.0</branch>
    </git>
    <url>https://commoncriteria.github.io/vpnclient/master/vpnclient.html</url>
  </include-pkg>



  <section title="Introduction" id="int">
    <section title="Overview" id="ppoverview"> 
      The scope of this PP-Module is to describe the security functionality of an Enterprise-Management product (EM) in terms of [CC] 
      and to define functional and assurance requirements for such products. This PP-Module is intended for use with the following Base-PPs:
      
      <h:ul>
        <h:li>Protection Profile for Application Software Version 2.0</h:li>
      </h:ul>
      
      This Base-PP is valid because an EM is deployed as a software application on a general-purpose operating system.
    </section>
    <tech-terms>
      <!-- <term abbr="AES" full="Advanced Encryption Standard"/>      -->
      <!--       <term abbr="ANSI" full="American National Standards Institute"/> -->
      <term abbr="API" full="Application Programming Interface"/>
      <!-- <term abbr="ASLR" full="Address Space Layout Randomization"/> -->
      <!--       <term abbr="CMC" full="Certificate Management over CMS"/> -->
      <!-- <term abbr="CMS" full="Cryptographic Message Syntax"/> -->
      <!--       <term abbr="CSA" full="Computer Security Act"/> -->
      <!-- <term abbr="DES" full="Data Encryption Standard"/> -->
      <!-- <term abbr="DHE" full="Diffie-Hellman Ephemeral"/> -->
      <!-- <term abbr="DNS" full="Domain Name System"/> -->
      <!-- <term abbr="DRBG" full="Deterministic Random Bit Generator"/> -->
      <!-- <term abbr="DSS" full="Digital Signature Standard"/> -->
      <!-- <term abbr="DT" full="Date/Time Vector"/> -->
      <!-- <term abbr="DTLS" full="Datagram Transport Layer Security"/> -->
      <term abbr="EA" full="Evaluation Activity"/>
      <!-- <term abbr="EAP" full="Extensible Authentication Protocol"/> -->
      <!-- <term abbr="ECDHE" full="Elliptic Curve Diffie-Hellman Ephemeral"/> -->
      <term abbr="ECDSA" full="Elliptic Curve Digital Signature Algorithm"/>
      <term abbr="FIPS" full="Federal Information Processing Standards"/>
      <term full="Endpoint">A computing device that runs a general purpose OS, mobile device OS, or network device OS. Endpoints can 
        include desktops, servers, and mobile devices.
      </term>
      
      <term full="Enrolled State">The state in which an endpoint with a running Host Agent is managed by an ESM.
        Also, referred to as Onboarding.
      </term>
      
      <term full="Enrollment">The process of transitioning an endpoint from an unenrolled to an enrolled state.
      </term>
      
      <term full="Enterprise Security Management" abbr="ESM">A type of application hosted on a server or cloud service that provides 
        support for security management, information flows, reporting, policy, and data analytics 
        in complex enterprise environments.
      </term>
      
      
      <term full="Endpoint Detection and Response" abbr="EDR">A system that analyzes collected EDR Host Agent data for detecting, 
        investigating, and remediating unauthorized activities on endpoints. 
      </term>
      <term full="Host Agent">A logical piece of software that executes on endpoints to collect data about the endpoint and
        executes commands sent to the endpoint from an ESM server
        or service. An example command sent to an endpoint could be to enforce a policy from an 
        ESM, to collect some files, or to run an OS command.
      </term>
      
      <!-- <term abbr="HMAC" full="Hash-based Message Authentication Code"/> -->
      <!-- <term abbr="HTTP" full="Hypertext Transfer Protocol"/> -->
      <!-- <term abbr="HTTPS" full="Hypertext Transfer Protocol Secure"/> -->
      <!-- <term abbr="IETF" full="Internet Engineering Task Force"/> -->
      <term abbr="IP" full="Internet Protocol"/>
      <term abbr="ISO" full="International Organization for Standardization"/>
      <term abbr="IT" full="Information Technology"/>
      <!-- <term abbr="ITSEF" full="Information Technology Security Evaluation Facility"/> -->
      
      <term abbr="NIAP" full="National Information Assurance Partnership"/>
      <term abbr="NIST" full="National Institute of Standards and Technology"/>
      <!-- <term abbr="OCSP" full="Online Certificate Status Protocol"/> -->
      <!-- <term abbr="OMB" full="Office of Management and Budget"/> -->
      
      <term full="Operating System" abbr="OS">Software that manages physical and logical resources and provides services
        for applications.
      </term>
      
      <!-- <term abbr="PII" full="Personally Identifiable Information"/> -->
      <!-- <term abbr="PKI" full="Public Key Infrastructure"/> -->
      <!-- <term abbr="RBG" full="Random Bit Generator"/> -->
      <!-- <term abbr="RFC" full="Request for Comment"/> -->
      <!-- <term abbr="RNG" full="Random Number Generator"/> -->
      <!-- <term abbr="RNGVS" full="Random Number Generator Validation System"/> -->
      <term abbr="RSA" full="Rivest, Shamir, Adleman (digital signature algorithm)"/>
      <!-- <term abbr="SAN" full="Subject Alternative Name"/> -->
      <!-- <term abbr="SHA" full="Secure Hash Algorithm"/> -->
      <!-- <term abbr="S/MIME" full="Secure/Multi-purpose Internet Mail Extensions"/> -->
      <!-- <term abbr="SIP" full="Session Initiation Protocol"/> -->
      <!-- <term abbr="SWID" full="Software Identification"/> -->
      
      <term full="Unenrolled State">The state in which an endpoint, with or without a Host Agent, is not managed by an ESM.
        Also, referred to as Offboarding.
      </term>
      <!-- <term abbr="TLS" full="Transport Layer Security"/> -->
      <!-- <term abbr="URI" full="Uniform Resource Identifier"/> -->
      <!-- <term abbr="URL" full="Uniform Resource Locator"/> -->
      <!-- <term abbr="USB" full="Universal Serial Bus"/> -->
      <!-- <term abbr="XCCDF" full="eXtensible Configuration Checklist Description Format"/> -->
      <!-- <term abbr="XOR" full="Exclusive Or"/> -->
    </tech-terms>
    
    <section title="Compliant Targets of Evaluation" id="TOEdescription">
      The PP-Module for Enterprise-Management covers the security functionality needed for a server in an ESM product to manage the configuration and behavior of endpoint systems in an enterprise setting, and providing monitoring and reporting capabilities for managed endpoints. <comment>potentially update this sentence or add a second one that clarifies why this is distinct from ESM EDR since they both involve "central server interfacing with endpoints".</comment> 
      
      <section title="TOE Boundary" id="toeboundary">
        The boundary for Enterprise-Management includes 
        all processes, all modules, and libraries bundled with the product, to be run on a single server or multiple servers in a load balancing or failover configuration. This includes any local or remote management interface that is used to access the TOE for the purpose of configuration (whether of itself or of endpoints under the TOE's control), audit review, or any other supported administrative function. The TOE boundary includes communications channels with external entities. The platform operating system or execution environment
        upon which the TOE is executing is outside the scope of an EM evaluation. The figures
        below show some sample Host Agents but are not inclusive of every possible Host Agent design <comment>TBD</comment>. 
        
        <!--
        <h:table>
          <h:tr>
            <h:td>
              <figure entity="images/Host_Agent_sample.png" title="Sample Host Agent TOE" id="toe"/>
            </h:td>
            <h:td>
              <figure entity="images/Host_Agent_sample2.png" title="Sample Host Agent TOE" id="toe2"/>
            </h:td>
          </h:tr>
        </h:table>
        -->
        
      </section>
      <section title="TOE Platform" id="TOEplatform">
        The TOE platform consists of a general purpose OS or an Execution Environment on top of which 
        the EM software executes.
      </section>
    </section>
    
    <section title="Use Cases" id="usecases">Requirements in this  PP-Module are designed to
      address the security problem for the following use cases. These use cases are intentionally
      very broad, as many different types of ESM Host Agent products may exist. As this PP-Module is revised to allow for more specific types of ESM Host Agent products, additional use cases
      may be devised. 
      <usecases>
        <usecase title="Interfacing with Endpoints" id="endpoints">
          <description>The TOE communicates with an endpoint system and issues commands to this system to push, edit, or retrieve data. This could include deployment or updates to system software, applying configuration settings, executing custom scripts against the system, or establishing interactive remote access to the system.
          </description>
        </usecase>
        <usecase id="inventory" title="System Inventory">
          <description>The TOE collects data about endpoint systems that can be queried or browsed. This could include data about the system's hardware, software, or configuration</description>
        </usecase>
        <usecase id="monitoring" title="System Monitoring">
          <description>The TOE has a persistent connection to endpoint systems to monitor those systems for anomalous activity, such as disk utilization, memory usage, configuration of system permissions, or the starting and stopping of executable services or processes on the system. <comment>is this meant to be the policy management side of EDR? Or is this something distinct and/or broader? If this is just meant to be the stuff that the ESM EDR module intends to capture then we should ensure consistency between the two.</comment></description>
        </usecase>
      </usecases>
    </section>
    
    
    <section title="Implementation-Based Features" id="sec-features">
      A conformant TOE may implement certain features that are not strictly necessary in order to achieve the desired level of security, but if these features are implemented, it is expected that they conform to certain requirements governing their behavior. 
      <implements>
        <feature id="distributed" title="Distributed TOE">
          <description>The TOE implements LiFi using IEEE 802.11bb. Data in transit is protected using either IPsec or RadSec (RADIUS over TLS).</description>
        </feature>
      </implements>			
    </section>   
    
  </section>

  <sec:Conformance_Claims boilerplate="no">
    <!-- The new CClaimsInfo construct --><comment>Update URLs in Bib. for pp and mod cc refs</comment> 
    <comment><h:b/><h:b/>Do we also need VPN Client here or is IPsec not an expected way these products will communicate? Note that neither EDR nor HA reference it so if we need those, we'll have to back them into the other modules</comment>
    
    <CClaimsInfo cc-version="cc-2022r1" cc-approach="direct-rationale">
      <cc-st-conf>exact</cc-st-conf>       
      <cc-pt2-conf>extended</cc-pt2-conf>
      <cc-pt3-conf>extended</cc-pt3-conf>
      <cc-pp-conf/>
      <cc-pp-config-with>       
        <!-- these will need to be replaced with updated versions of the PPs/Mods <Mod-cc-ref>Protection Profile for Mobile Device Management Version 4.0</Mod-cc-ref>  
				
				<Mod-cc-ref>PP-Module for Endpoint Detection and Response, Version 1.0</Mod-cc-ref>  
				<Mod-cc-ref>PP-Module for Host Agent, Version 1.0</Mod-cc-ref>  
				 --> 
        <PP-cc-ref>Protection Profile for Application Software Version 2.0 </PP-cc-ref>
        <Mod-cc-ref>PP-Module for Endpoint Detection and Response (EDR), Version 2.0 </Mod-cc-ref>
        <Mod-cc-ref>PP-Module for Host Agent (HA), Version 2.0</Mod-cc-ref>
        
      </cc-pp-config-with>
      <cc-pkg-claim>
        <FP-cc-ref conf="conformant">Functional Package for TLS, Version 2.1</FP-cc-ref>
      </cc-pkg-claim>
      
    </CClaimsInfo>
  </sec:Conformance_Claims>
      
      <section title="Security Problem Definition" id="spd">The security problem is described in terms
        of the threats that the TOEis expected to address, assumptions about the
        Operational Environment, and any organizational security policies that the TOE
        is expected to enforce. These extend any threats, assumptions, and organizational security policies defined by the Base-PP.
        
        <comment><h:br/><h:br/>Note that these threats are nearly duplicates of the App PP and the things that are inherited from that PP do not need to be redefined; suggest reviewing these once SFRs are fully defined to adjust specifically to the context of this TOE (versus a general App PP TOE).</comment>
        <section title="Threats" id="threats">Note that this PP-Module does not repeat the threats identified in the <xref to="bibAppPP"/>, though they all apply given the conformance and hence dependence of this PP-Module on the <xref to="bibAppPP"/>.
          
          
          <threats>
            <threat name="T.NETWORK_ATTACK">
              <description>An attacker is positioned on a communications channel or elsewhere on the network infrastructure. Attackers may engage in communications with parts of the EM system with the intent of compromise. Engagement may consist of altering existing legitimate communications. </description>
          
            </threat>
            <threat name="T.NETWORK_EAVESDROP">
              <description>An attacker is positioned on a communications channel or elsewhere on the network infrastructure. Attackers may monitor and gain access to data exchanged between parts of the EM system.</description>
            </threat>
            
            <threat name="T.LOCAL_ATTACK">
            <description>An attacker may compromise applications running on the same computing platform on which part of the EM system executes. The compromised application may provide maliciously formatted input to the EM system through a variety of channels including unprivileged system calls and messaging via the file system. </description>
            </threat>
              
            <threat name="T.LIMITED_PHYSICAL_ACCESS">
              <description>An attacker may attempt to access EM system data at rest on the endpoint devices.</description>
            </threat>
          </threats>
        </section>
        <section id="Assumptions" title="Assumptions">
          
          
          This PP-Module defines no additional assumptions beyond those defined in the Base-PP.
          <assumptions/> 
        </section>
        
        <sec:Organizational_Security_Policies>
          <OSPs/>
        </sec:Organizational_Security_Policies>
      </section>
      
      
      <!-- SME: right now not all objectives in the Module are mapped to threats because the template requires these
  to be defined with respect to the threats. Some objectives in the Module mitigate threats inherited from the Base-PP
  and are not restated in the Module. As a result the mappings are incomplete. This will need to be resolved. -->
      <section title="Security Objectives" id="obj">
        
        <section title="Security Objectives for the Operational Environment"
          id="SecurityObjectivesTOEorEnvironment">
        </section>
        
      </section>

  <section title="Security Requirements" id="req">
    <comment>Update URLs once new versions published</comment>
    <base-pp id="AppPP" name="Application Software" product="Application" short="App" version="2.0" >
      <git>
        <url>https://github.com/commoncriteria/application</url>
        <branch>release-2.0</branch>
      </git>
      <url>https://www.niap-ccevs.org/protectionprofiles/516</url>
      <sec-func-req-dir>
        In a PP-Configuration that includes App PP, the TOE is expected to rely on some of the security functions implemented by the application 
        as a whole and evaluated against the Base-PP.
        The SFRs listed in this section are defined in the Base-PP and relevant to the secure operation of the TOE.
        This section describes any modifications that the ST author must make to the Base-PP SFRs to satisfy the required Enterprise-Management functionality.
      </sec-func-req-dir>
      
      <modified-sfrs/>
      <additional-sfrs/>
      
      <con-toe>
        If this PP-Module is used to extend the Application Software PP, the TOE type for the overall TOE is still a
        software-based application. The TOE boundary is simply extended to include the Enterprise-Management functionality 
        that is built into the application so that additional security functionality is claimed within the scope of the TOE.
      </con-toe>
      
      <con-sec-prob/>
      <con-obj/>
      <con-op-en>
        This PP-Module does not define any objectives for the TOE's Operational Environment. 
      </con-op-en>
      
     
    </base-pp>
    
    <man-sfrs>
      <section id="sec-sel-audit-table" title="Auditable Events for Mandatory SFRs">
        <audit-table id="at-Man" table="mandatory"/>
      </section>
      <section title="Security Audit (FAU)" id="fau">
		
	
		  <ext-comp-def title="Server Alerts" fam-id="FAU_ALT_EXT">
		    <fam-behavior>This family defines requirements for the TSF to alert administrators when a set of
		      specified events occurs.</fam-behavior>		  
		  </ext-comp-def>
	    <ext-comp-def title="Support for Compliance Reporting Configuration"
	      fam-id="FAU_CRP_EXT">
	      <fam-behavior>This family defines requirements for the TSF to generate compliance reports of the configuration of external entities.</fam-behavior>
	    </ext-comp-def>
	     <ext-comp-def title="Network Reachability Review" fam-id="FAU_NET_EXT">
	       <fam-behavior>This family defines requirements for administrators to see network
	         connectivity status of external entities managed by the TOE.</fam-behavior>
	     </ext-comp-def>		  	  
	  
        <f-component cc-id="fau_alt_ext.1" name="Server Alerts">
          <consistency-rationale/>
          <comp-lev>defines requirements for alerting the administrator to events.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT.
          <h:ul>
            <h:li>Install policies.</h:li>
          </h:ul>
          </management>
          <audit>The following actions should be auditable if FAU_GEN security audit data generation
          is include in the PP or ST.
          <h:ul>
            <h:li>Type of alert.</h:li>
            <h:li>Identity of external entity that sent alert.</h:li>
          </h:ul>
          </audit>
          <dependencies>No dependencies.</dependencies>
          
          <f-element id="fau-alt-ext-1e1">
            <title><comment>ESR: configuration of EM system, auditing and compliance<h:br/>
            Adapted from MDM PP requirement of the same name<h:br/>
              <h:br/>Note that the specific events that trigger an alert may need to be updated depending on the intended minimum functionality of the EM TOE.<h:br/></comment>
              The TSF shall alert the administrators in the event of any of the following:
              <h:ul>
                <h:li>Change in management status (i.e., adding system or agent to management, removing system or agent from management)</h:li>
                <h:li>Failure to respond to heartbeat or check in during designated reporting interval</h:li>
                <h:li><selectables><selectable><assignable>other events</assignable></selectable><selectable>no other events</selectable></selectables></h:li>
              </h:ul>
            </title>
            <note role="application"> An alert can be defined as anything providing straightaway notice to the administrator. An alert is different from 
		    an audit record, however the fact that an alert was sent should be audited per FAU_GEN.1. Email, pop-up notifications, or other methods 
		    are acceptable forms of alerts.<h:br/><h:br/>            
              The expectation of this requirement is that the TOE has a mechanism to configure the heartbeat or reporting interval of systems or agents that are under its management. The inability of the system or agent to maintain this mechanism should be flagged by the TSF as anomalous behavior requiring further examination and potential corrective action. This necessarily includes a mechanism to identify the assets under management and when they are added or removed.</note>
            <aactivity>
              <no-tests/>
            </aactivity>
          </f-element>
			<audit-event>
				<audit-event-descr>Type of alert</audit-event-descr>
				<audit-event-info>Identity of system or agent that sent alert</audit-event-info>
			</audit-event>
		</f-component>
		
        <f-component cc-id="fau_crp_ext.2" name="Generation of Compliance Reports">
          <consistency-rationale/>
          <comp-lev>defines requirements for the contents and presentation of compliance reports.</comp-lev>
          <management>No specific management functions are identified.</management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies><no-link>FTP_ITC.1</no-link> Inter-TSF Trusted Channel</dependencies>
          
          <f-element id="fau-crp-ext-2e1">
              <title><comment>ESR: auditing and compliance<h:br/>
                Adapted from MDM PP requirement of the same name<h:br/>
                <h:br/>Note that this is currently very generic because we will need TC/SME input on the minimum "compliance reporting" functionality of the EM TOE (i.e. is there a minimum set of things it needs to be able to check on, or potentially multiple such selectable sets depending on intended usage).<h:br/></comment>
              The TSF shall provide the ability to generate compliance reports reports of the configuration status of managed
              <selectables>
                <selectable>systems</selectable>
                <selectable>agents</selectable>
              </selectables> based on the following configuration attributes:
              channel that meets the secure channel requirements in FTP_ITC.1. The provided information for each enrolled mobile device includes:
              <h:ul>
              <h:li><comment>TBD</comment></h:li>
              <h:li>List of configuration policies that are in place on the device (as defined in 
                <xref to="fel-smf-man-agnt"/>)</h:li>
            </h:ul>
            </title>
          
            <note role="application">The intent of this requirement is that the TOE be able to provide 
              compliance information about managed systems, whether that is obtained through querying the system itself or by interfacing with an agent running on the system for this purpose. 
            </note>
            <aactivity>
             <no-tests/>
            </aactivity>
          </f-element>
        	<audit-event/>
		</f-component> 
	
        <f-component cc-id="fau_gen.1" name="Audit Data Generation">          
			<f-element id="fel-gen-func-tsf">
			  <title><comment>ESR: auditing and compliance<h:br/>
			    Adapted from MDM PP requirement of the same name (for management of MDM Agents)<h:br/>
			    <h:br/>Note that this is currently very generic because we will need TC/SME input on the minimum audit data generation functionality of the EM TOE (i.e. is there a minimum set of things it needs to be able to log, or potentially multiple such selectable sets depending on intended usage).<h:br/></comment>
				  The TSF shall 
					<selectables>
						<selectable>invoke platform-provided functionality</selectable>
						<selectable>implement functionality</selectable>
					</selectables> to generate audit data of the following auditable events: 
					<h:ol type="a">
						<h:li>All administrative actions</h:li>
						<h:li>
							Commands issued to managed <selectables>
								<selectable>system</selectable>
								<selectable>agent</selectable>
								</selectables>
						</h:li>
						<h:li>Specifically defined auditable events listed in <xref g="t-audit-mandatory"/></h:li>                    
					  <h:li><selectables linebreak="yes">
					    <selectable>Startup and shutdown of the audit functions</selectable>
              <selectable id="sel-at2"><refinement>Auditable events defined in <xref g="t-audit-optional"/> for Strictly Optional SFRs</refinement></selectable>
					    <selectable id="sel-at3"><refinement>Auditable events defined in <xref g="t-audit-objective"/> for Objective SFRs</refinement></selectable>
					    <selectable id="sel-at4"><refinement>Auditable events defined in <xref g="t-audit-sel-based"/> for Selection-Based SFRs</refinement></selectable>
					    <selectable id="sel-attls"><refinement>Auditable events defined in the audit table for the TLS Functional Package (see <xref to="atref-pkgs"/>)</refinement></selectable>
              <selectable>no other events</selectable>
						</selectables>.</h:li>						
					</h:ol>
				</title>
            <note role="application">
				This requirement outlines the events for which audit data must be generated by either the TOE or by its underlying platform. It is acceptable for this requirement to met through a combination of platform-provided and TOE-provided audit functions, so long as the full set of required events are generated and include the required data.<h:br/><h:br/>
           
				Item <h:b>a</h:b> above requires all administrative actions to be auditable. Administrative actions refer to any management functions specified by 
				FMT_MOF.1. Thus no additional specification for the auditability of these actions is specified in <xref g="t-audit-mandatory"/> aside 
				from those that require additional record content.<h:br/><h:br/>
              
				Item <h:b>b</h:b> includes any commands that are performed against a managed system or agent. This need not go to the granularity of individual API calls, but it is expected that there is sufficient data to be clear to an administrator what actions the TOE may be performing against an external entity or what data it may be receiving from it.<h:br/><h:br/>
              
				Depending on the specific requirements selected by the ST author from SFR, optional requirements, selection-based
				requirements, and objective requirements, the ST author should include the appropriate auditable
				events from <xref g="t-audit-optional"/>, <xref g="t-audit-sel-based"/>, and <xref g="t-audit-objective"/> in the
              ST for the requirements selected.<h:br/><h:br/>
              
              <h:b>In item d above, "startup and shutdown of the audit functions" may refer to the independent startup and shutdown of audit functionality specifically, or it may refer to startup and shutdown of the TOE itself, if auditing cannot be disabled separately from the operation of the TOE. It is outside the scope of the TOE boundary to consider the need to audit the startup and shutdown of auditing functionality used by the TOE platform, as this would be an inherent function of the host operating system. </h:b><h:br/><h:br/>     
		    	The following table contains the events enumerated in the auditable events tables for the TLS Functional Package. Inclusion of these events
		    	in the ST is subject to selection above, inclusion of the corresponding SFRs in the ST, and support in the FP as represented by a selection
		    	in the FP audit table. This list is included here for reference.<h:br/><h:br/>
							<h:b><ctr ctr-type='Table' id="atref-pkgs" pre="Table ">: Auditable Events for Functional Packages</ctr></h:b>							
							<h:table>
								<h:tr class="header"><h:td>Requirement</h:td><h:td>Auditable Events</h:td><h:td>Additional
								  Audit Data Contents</h:td></h:tr>

								<h:tr><h:td>FCS_TLSC_EXT.1</h:td>
								<h:td>Failure to establish a TLS session.</h:td>
								<h:td>Reason for failure.</h:td></h:tr>
								
								<h:tr><h:td>FCS_TLSC_EXT.1</h:td>
								<h:td>Failure to verify presented identifier.</h:td>
								<h:td>Presented identifier and reference identifier.</h:td></h:tr>

								<h:tr><h:td>FCS_TLSS_EXT.1</h:td>
								<h:td>Failure to establish a TLS session.</h:td>
								<h:td>Reason for failure.</h:td></h:tr>

								<h:tr><h:td>FCS_DTLSC_EXT.1</h:td>
								<h:td>Failure of the certificate validity check.</h:td>
								<h:td>Issuer Name and Subject Name of certificate.</h:td></h:tr>
							
								<h:tr><h:td>FCS_DTLSS_EXT.1</h:td>
								<h:td>Failure of the certificate validity check.</h:td>
								<h:td>Issuer Name and Subject Name of certificate.</h:td></h:tr>
							</h:table>
				
            </note>
            <aactivity level="element">
         <no-tests/>
            </aactivity>
          </f-element>
          <f-element id="fel-gen-tsf-info">
            <title> The TSF shall record within the audit data at least the following information: <h:ul>
              <h:li>date and time of the event</h:li>
              <h:li>type of event</h:li>
              <h:li>subject identity (if applicable)</h:li>
              <h:li>and the outcome (success or failure) of the event</h:li>
              <h:li>additional information in <xref g="t-audit-mandatory"/></h:li>
              <h:li><selectables linebreak="yes">
                    <selectable id="sel-at2-i">additional information defined in <xref g="t-audit-optional"/> for Strictly Optional SFRs</selectable>
					          <selectable id="sel-at3-i">additional information defined in <xref g="t-audit-objective"/> for Objective SFRs</selectable>
                    <selectable id="sel-at4-i">additional information defined in <xref g="t-audit-sel-based"/> for Selection-Based SFRs</selectable>
					          <selectable id="sel-attls-i">additional information defined in the audit table for the TLS Functional Package (see <xref to="atref-pkgs"/>)</selectable>
                    <selectable>no other additional information</selectable>
				</selectables></h:li>
            </h:ul>
            </title>
            <note role="application"> This requirement outlines the information to be included in audit data. All audits must contain at least the
		            information mentioned in <xref to="fel-gen-tsf-info"/>, but may contain more information. The ST author
		            must identify what audit data is generated by the TOE in its own audit mechanism versus audit data generated by the TOE platform based on the TOE's operation. <h:br/><h:br/>
       
            </note>
            <aactivity level="element">
             <no-tests/>
            </aactivity>
          </f-element>
        <audit-event/>
		</f-component>
        
        
        <f-component cc-id="fau_net_ext.1" name="Network Reachability Review">
          <consistency-rationale/>
          <comp-lev>defines requirements for authorized administrators to read network connectivity
            status.</comp-lev>
          <management>The following actions could be considered for the management functions in FMT.
            <h:ul>
              <h:li>Query connectivity status.</h:li>              
            </h:ul></management>
          <audit>There are no auditable events foreseen.</audit>
          <dependencies>No dependencies.</dependencies>
          
          <f-element id="fau-net-ext-1e1">
            <title><comment>ESR: configuration of EM system, auditing and compliance<h:br/>
              Adapted from MDM PP requirement of the same name<h:br/></comment>
              The TSF shall provide authorized administrators with the capability to read the network connectivity status of an external entity.</title>
            <note role="application">Depending on whether the external entity is a system or a specific agent residing on the system, the network connectivity status may be registered with an ICMP ping or other generic mechanism, or through an API or other function that is specific to the agent or interface the TOE interacts with to perform management functions.</note>
            <aactivity>
              <no-tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component> 
        
        <f-component cc-id="fau_stg.1" name="Audit Data Storage Location">
          <f-element id="fau-stg-1e1">
            <title><comment>ESR: auditing and compliance<h:br/>
              Adapted from MDM PP requirement of the same name<h:br/></comment>
              The TSF shall be able to <h:b>transmit the generated audit data to an external IT
              entity using a trusted channel according to FTP_ITC.1</h:b> and store
              generated audit data on the 
              <selectables>
                <selectable id="locally">TOE itself</selectable>
                <selectable>no other storage</selectable>
              </selectables>.
            </title>
            <note role="application">The TOE must be capable of transmitting audit data to an external entity 
              using a trusted channel as specified in FTP_ITC.1 and optionally can store audit data locally in addition to this. 
              If "store audit data locally" is selected, then <xref to="fel-stg-func"/> must be included in the 
              ST.<h:br/><h:br/> 
              
              This requirement only applies to audit data maintained by the TSF, not audit data that is maintained 
              by the platform. Audit data may include the audit records received from external entities, in addition to the audit records 
              generated by the TOE.<h:br/><h:br/>
              
              The TOE may rely on a non-TOE audit server for storage and review of audit data. 
              Although the TOE generates audit data and receives audit data from MDs, the 
              storage of this audit data and the ability to allow the administrator to review this
              audit data is provided by 
              the operational environment. The TSF may rely on the underlying operating system for this 
              functionality.<h:br/><h:br/> 
              
              Although the audit server is outside of the TOE, the TSF should still be able to support 
              mutual authentication. There are no requirements levied on the audit server, but the TOE should be 
              able to support TLS client certificate authentication. This way if the non-TOE audit server does 
              support verifying client certs, the TSF is able to make use of that.<h:br/><h:br/>
              
              If <xref to="locally"/> is chosen, FAU_STG.2 must be included in the ST.              
              
            
            </note>
            <aactivity>
             <no-tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>
        
        
		</section>
      
      <section id="man-fia" title="Identification and Authentication (FIA)">
        
        <f-component cc-id="fia_uau.1" name="Timing of Authentication">
          <f-element id="fia-uau-1e1">
            <title><comment>ESR: authentication and authorizatione<h:br/>
              Adapted from MDM PP requirement of the same name<h:br/></comment>
              The TSF shall <selectables>
              <selectable><h:b>invoke platform-provided functionality</h:b></selectable>
              <selectable><h:b>implement functionality</h:b></selectable>
            </selectables> <h:b>to</h:b> allow <assignable>list of TSF mediated actions</assignable> on behalf of the user to be performed before the user is authenticated.</title>
            
          </f-element>
          <f-element id="fel-uau-func">
            <title>The TSF shall <selectables>
              <selectable><h:b>invoke platform-provided functionality</h:b></selectable>
              <selectable><h:b>implement functionality</h:b></selectable>
            </selectables> <h:b>that</h:b> requires each user to be successfully authenticated before allowing any other TSF-mediated actions on behalf of that user.</title>
            <note role="application">This requirement ensures that any user attempting to access the TSF must be authenticated. The ST author is responsible for assigning 
              the list of actions that can take place (if any) before this authentication. The TSF or TOE platform may
              use enterprise authentication to meet this 
              requirement (e.g., integration with enterprise directory services for single sign-on). An application that is installed in the context of a particular OS user such that the authentication context is inherited from logging in to the TOE platform as that user is also an example of authentication being facilitated through invocation of platform-provided functionality.<h:br/><h:br/>
            </note>
            <aactivity>              
              <no-tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component> 
        
      </section>
      
      <section id="man-fmt" title="Management of the TSF (FMT)">
        
        
        <f-component cc-id="fmt_mof.1" name="Management of Security Functions Behavior">
          <f-element id="fel-gen-mas">
            <title><comment>ESR: Endpoint and Agent Management; Permission Segregation<h:br/>
              Adapted from MDM PP requirement of the same name<h:br/></comment>
              The TSF shall restrict the ability to <h:b>perform</h:b> the functions <h:ul>
              <h:li>listed in FMT_SMF.1/External</h:li>
              <h:li>listed in FMT_SMF.1/Internal</h:li>
            </h:ul> to <assignable>authorized administrative roles for each function</assignable>.</title>
            <note role="application">This requirement defines the permissions necessary to execute or manage the behavior of functions used for both management of external entities (i.e. Enterprise-Management) as defined in FMT_SMF.1/Internal as well as the TOE itself. The ST author will define, for each claimed administrative function, any roles that are authorized to perform this function. Roles may be predefined by the TOE, inherited from an organizational directory, or custom based on privileges assigned to a role that the TOE has the ability to create.<h:br/><h:br/>
              Role assignment in and of itself may not be sufficient to authorize a function; it may be the case that scoping rules also define the specific set of objects that the function may be performed against. Examples could include a user having the ability to reset only their own password while an administrator has the ability to reset any user's password, or two different users being able to perform the same Enterprise-Management functions against two groups of external entities.
            </note>
            <aactivity>
            <no-tests/>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Issuance of command to perform function</audit-event-descr>
            <audit-event-info>Command sent and identity external recipients</audit-event-info>
          </audit-event>
          <audit-event>
            <audit-event-descr>Change of policy settings</audit-event-descr>
            <audit-event-info>Policy changed and value or full policy</audit-event-info>
          </audit-event>
        </f-component>
          
        <f-component cc-id="fmt_smf.1" iteration="External"
		     name="Specification of Management Functions (Server configuration of External Systems)">
          <f-element id="fel-smf-man-ext">
            <title><comment>ESR: The EM server/agents shall have a mechanism to report patch levels and initiate the patching process<h:br/>
              ESR: The EM server/agents shall have a mechanism to report patch levels and initiate the patching process<h:br/>  
              Adapted from MDM PP requirement of the same name<h:br/>
            Incomplete/placeholder as more things will likely be needed (whether mandatory or selectable) based on desired EM functionality.<h:br/></comment>
            The TSF shall be capable of performing the following management functions 
              <h:b>against external systems</h:b>
              <h:ul style="list-style-type:none">
                <h:li><ctr id="smf1" ctr-type="mgmt" pre=""></ctr>. Configuration of reporting interval</h:li>
                <h:li><ctr id="smf2" ctr-type="mgmt" pre=""></ctr>. Query patch levels</h:li>
                <h:li><ctr id="smf3" ctr-type="mgmt" pre=""></ctr>. Apply patches</h:li>
              </h:ul> 
              <h:b>and the following commands against external systems:</h:b> <comment>do we actually need a separate list of "commands" vs "functions"? It seems like invoking APIs could exist separately from more holistic functions but not sure if we need to go into that granular detail or if we can just collectively bundle up related APIs into the notion of "functions" themselves</comment><h:br/>
                <selectables>
                <selectable><ctr id="smf4" ctr-type="mgmt" pre=""></ctr>. TBD</selectable>
                <selectable><ctr id="smf5" ctr-type="mgmt" pre=""></ctr>. TBD</selectable>
              
              </selectables>.
            </title>
            <note role="application"> This requirement captures all the configuration functionality that the TSF provides to interact with external entities, whether these entities are standalone systems, or purpose-built agents running on these systems.</note>
            <aactivity>
          <no-tests/>
            </aactivity>
          </f-element>
        	<audit-event/>
		</f-component>
		
        <f-component cc-id="fmt_smf.1" iteration="Internal" name="Specification of Management Functions (Server Configuration of Server)">
          <f-element id="fmt-smf-1e1">
            <title><comment>ESR: Compliance
              Adapted from MDM PP requirement of the same name (for management of the MDM Server itself)<h:br/>
              Incomplete/placeholder as the management functionality necessary for the server must be defined (e.g. configuration of cryptographic channels, configuration of X.509 certs/trust anchors, configuration of user accounts). Note that some of this may be selectable as being implemented by the TOE or by the platform (or not at all, depending on what is claimed).<h:br/></comment>
              
              The TSF shall be capable of performing the following management functions <h:b>for configuration of the TSF</h:b>: <assignable>list of management functions</assignable>
              
            </title>
            <note role="application"> This requirement addresses the management functions the TOE provides to manage its own behavior (as opposed to managing the behavior of external entities)     
            </note>
            <aactivity>
              <no-tests/>
            </aactivity>
          </f-element>
        	<audit-event>
				<audit-event-descr>Success or failure of function</audit-event-descr>
			</audit-event>
		</f-component> 
        
        
        <f-component cc-id="fmt_smr.1" name="Security Roles">
          <f-element id="fmt-smr-1e1-sr">
            <title><comment>ESR: Endpoint and Agent Management; Permission Segregation<h:br/>
              Adapted from MDM PP requirement of the same name<h:br/></comment>
              The TSF shall maintain the roles <assignable>the authorized identified roles</assignable>.</title>
          </f-element>
          <f-element id="fel-smr-users-roles">
            <title>The TSF shall be able to associate users with roles.</title>
            <note role="application">This PP-Module does not require a fixed set of arbitrarily-named roles. The purpose of this requirement is for the ST author to document how users are organized for the purpose of determining the authorizations they have to interact with the TSF, as specified in FMT_MOF.1.
            </note>
            <aactivity>
              <no-tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component>   
        
      </section>
      
      <section id="man-ftp" title="Trusted Path/Channels (FTP)">
        
        <f-component cc-id="ftp_itc.1" name="Inter-TSF Trusted Channel (Authorized IT Entities)"> 
          <f-element id="fel-inter-xfer-it"> 
            <title><comment>ESR: confidentiality and integrity of data-at-rest and in-transit<h:br/>
              Adapted from MDM PP requirement of the same name<h:br/></comment>
              The TSF shall <selectables>
              <selectable><h:b>invoke platform-provided functionality to use <selectables linebreak="yes">
                <selectable id="ITC1_IPSEC_INVOKE">IPsec</selectable>
                <selectable id="ITC1_SSH_INVOKE">SSH</selectable>
                <selectable id="ITC1_TLS_INVOKE">mutually authenticated TLS</selectable>
                <selectable id="ITC1_DTLS_INVOKE">mutually authenticated DTLS</selectable>
                <selectable id="ITC1_HTTPS_INVOKE">HTTPS</selectable>
              </selectables></h:b></selectable>
              <selectable><h:b>implement functionality using <selectables linebreak="yes">
                <selectable id="ITC1_IPSEC_IMPLEMENT">IPsec as defined in the PP-Module for VPN Client</selectable>
                <selectable id="ITC1_SSH_IMPLEMENT">SSH as defined in the Functional Package for Secure Shell</selectable>
                <selectable id="ITC1_TLS_IMPLEMENT">mutually authenticated TLS as defined in the Package for Transport Layer Security</selectable>
                <selectable id="ITC1_DTLS_IMPLEMENT">mutually authenticated DTLS as defined in the Package for Transport Layer Security</selectable>
                <selectable id="ITC1_HTTPS_IMPLEMENT">HTTPS in accordance with FCS_HTTPS_EXT.1 as defined in the Base-PP</selectable>
              </selectables></h:b></selectable></selectables> <h:b>to</h:b> provide a <h:b>trusted</h:b>
              communication channel between itself and <h:b>authorized</h:b> IT <h:b>entities supporting the following capabilities: connectivity to remote <selectables><selectable>systems</selectable><selectable>agents</selectable></selectables>, audit server,
                <selectables>
                  <selectable>authentication server</selectable>
                  <selectable><assignable>other capabilities</assignable></selectable>
                </selectables></h:b> that is logically distinct from other communication channels and provides assured identification of its endpoints
              and protection of the channel data from modification or disclosure.</title>
            <note role="application">The intent of the mandatory portion of the above requirement is to use the cryptographic 
              protocols identified in the requirement to establish and maintain a trusted channel with authorized IT entities 
              that the TOE interacts with to perform its functions.<h:br/><h:br/> 
              Protection (by one of the listed protocols) is required at least for communications with the IT entities managed by the TOE (whether those are systems that are managed using APIs provided by those systems by default, specialized agents running on systems that are designed for the purpose of interacting with the TOE, or both) and with
              the server that collects 
              the audit information. If it communicates with an authentication server (e.g., RADIUS), then the ST 
              author chooses "authentication server" in FTP_ITC.1.1 and this connection must be protected 
              by one of the listed protocols. If other authorized IT entities (e.g., NTP server) are protected, the 
              ST author makes the appropriate assignments (for those entities) and selections (for the protocols 
              that are used to protect those connections).<h:br/><h:br/> 
              To summarize, all communications with external entities that require protection of data in transit must be defined and must use one of the protocols specified in the requirement. At minimum, the TSF must communicate with external entities for the purpose of performing Enterprise-Management functions against them, and with a remote audit server for external storage of audit data. Additional channels are not required in order for the TOE to achieve its minimum required functionality, but if any such channels are implemented, appropriate protections must be provided for them.<h:br/><h:br/>
              
              The trusted channel uses IPsec, TLS, DTLS, or HTTPS as the protocol that preserves the confidentiality and integrity of external communications. The ST 
              author chooses the mechanism or mechanisms supported by the TOE.<h:br/><h:br/>
              If "IPsec as defined in the PP-Module for VPN Client" is selected, the TSF must claim conformance to a PP-Configuration that includes the VPN Client 
              PP-Module.<h:br/><h:br/>
              If HTTPS is chosen, FCS_HTTPS_EXT.1 must be included in the ST.<h:br/><h:br/>
              If the ST author selects "SSH as defined in the Functional Package for Secure Shell," the TSF must be validated against the FP for Secure Shell. It should be noted that due to constraints imposed by this PP that SHA-1 cannot be used.<h:br/><h:br/>
              If the ST author selects "mutually authenticated TLS as defined in the Package for Transport Layer Security" or "mutually authenticated DTLS as 
              defined in the Package for Transport Layer Security," the TSF must be validated against requirements from the Package for Transport Layer Security,
              with the following selections made:
              <h:ul>
                <h:li>FCS_TLS_EXT.1: 
                  <h:ul>
                    <h:li>either TLS or DTLS is selected depending on the selection made in FTP_ITC.1.1</h:li>
                    <h:li>either client or server is selected as appropriate</h:li>
                  </h:ul>
                </h:li>
                <h:li>FCS_TLSC_EXT.1.1 or FCS_TLSS_EXT.1.1 (as appropriate):
                  <h:ul>
                    <h:li>The cipher suites selected must correspond with the algorithms and hash functions allowed in FCS_COP.1.</h:li>
                    <h:li>mutual authentication must be selected</h:li>
                  </h:ul>
                </h:li>
                <h:li>FCS_DTLSC_EXT.1.1 or FCS_DTLSS_EXT.1.1 (as appropriate):
                  <h:ul>
                    <h:li>The cipher suites selected must correspond with the algorithms and hash functions allowed in FCS_COP.1.</h:li>
                    <h:li>mutual authentication must be selected</h:li>
                  </h:ul>
                </h:li>
              </h:ul> 
              Protocol, RBG, Certificate validation, algorithm, and similar services may be met with
              platform-provided 
              services.<h:br/><h:br/> 
              The requirement implies that not only are communications protected when they are initially established, but 
              also on resumption after an outage. It may be the case that some part of the TOE setup involves 
              manually setting up tunnels to protect other communication, and if after an outage the TOE attempts 
              to re-establish the communication automatically with (the necessary) manual intervention, there may be a window created 
              where an attacker might be able to gain critical information or compromise a connection.<h:br/><h:br/>
            </note>            
          </f-element>
          
          <f-element id="ftp-itc-1e2-ixi">
            <title>The TSF shall <selectables>
              <selectable><h:b>invoke platform-provided functionality</h:b></selectable>
              <selectable><h:b>implement functionality</h:b></selectable>
            </selectables> <h:b>to</h:b> permit <h:b>the MDM server or other authorized IT entities</h:b> to initiate communication via the trusted channel.</title>
          </f-element>
          
          <f-element id="fel-itc-init">
            <title>The TSF shall <selectables>
              <selectable><h:b>invoke platform-provided functionality</h:b></selectable>
              <selectable><h:b>implement functionality</h:b></selectable>
            </selectables> <h:b>to</h:b> initiate communication via the trusted channel for
              <assignable>list of functions for which a trusted channel is required</assignable>.</title>
            <note role="application">While there are no requirements on the party initiating the
              communication, the ST author lists in the assignment for <xref to="fel-itc-init"/>
              the services for which the TOE can initiate the communication with
              the authorized IT entity.</note>
            <aactivity>
              <no-tests/>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation and termination of the trusted channel</audit-event-descr>
            <audit-event-info>Trusted channel protocol</audit-event-info>
            <audit-event-info>Non-TOE endpoint of connection</audit-event-info>
          </audit-event>
        </f-component>
        
        
        
        <f-component cc-id="ftp_trp.1" name="Trusted Path">
          <f-element id="trustpath-rem-admin">
            <title><comment>ESR: confidentiality and integrity of data-at-rest and in-transit<h:br/>
              Adapted from MDM PP requirement of the same name<h:br/></comment>
            The TSF shall <selectables linebreak="yes">
              <selectable><h:b>invoke platform-provided functionality to use <selectables linebreak="yes">
                <selectable id="TRP1_IPSEC_INVOKE">IPsec</selectable>
                <selectable id="TRP1_TLS_INVOKE">TLS</selectable>
                <selectable id="TRP1_HTTPS_INVOKE">HTTPS</selectable>
                <selectable id="TRP1_SSH_INVOKE">SSH</selectable>
              </selectables></h:b></selectable>
              <selectable><h:b>implement functionality using <selectables linebreak="yes">
                <selectable id="TRP1_IPSEC_IMPLEMENT">IPsec as defined in the PP-Module for VPN Client</selectable>
                <selectable id="TRP1_TLS_IMPLEMENT">TLS as defined in the Package for Transport Layer Security</selectable>
                <selectable id="TRP1_HTTPS_IMPLEMENT">HTTPS in accordance with FCS_HTTPS_EXT.1 as defined in the Base-PP</selectable>
                <selectable id="TRP1_SSH_IMPLEMENT">SSH as defined in the Functional Package for Secure Shell</selectable>
              </selectables></h:b></selectable></selectables> <h:b>to</h:b> provide a <h:b>trusted</h:b>
              communication path between itself <h:b>as a <selectables>
                <selectable>server</selectable>
                <selectable>peer</selectable>
              </selectables></h:b> <h:b>and another trusted IT product</h:b> that is logically distinct from other communication <h:b>channels</h:b> and provides assured
              identification of its endpoints and protection of the <h:b>channel</h:b> data from [<h:i>modification or disclosure.</h:i>]</title> 
          </f-element>
          
          <f-element id="ftp-trp-1e2-tra">
            <title>The TSF shall <selectables>
              <selectable><h:b>invoke platform-provided functionality</h:b></selectable>
              <selectable><h:b>implement functionality</h:b></selectable>
            </selectables> <h:b>to</h:b> permit <selectables>
              <selectable>the TSF</selectable>
              <selectable>another trusted IT product</selectable>
            </selectables> to initiate communication via the trusted <h:b>channel</h:b>.</title>
          </f-element>
          
          <f-element id="ftp-trp-1e3-tra">
            <title>The TSF shall <selectables>
              <selectable><h:b>invoke platform-provided functionality</h:b></selectable>
              <selectable><h:b>implement functionality</h:b></selectable>
            </selectables> <h:b>to</h:b> initiate communication via the trusted <h:b>channel</h:b> for
              <assignable>list of functions for which a trusted channel is required</assignable>.</title>
            <note role="application">This requirement ensures that authorized remote administrators initiate all 
              communication with the TOE via a trusted path, and that all communications with 
              the TOE by remote administrators is performed over this path. This requirement is optional because it may be the case that the TOE is launched as an application local to the server on which it is installed, such that if the administrator is accessing the TSF remotely, the remote access is achieved through a remote session with the TOE platform (as opposed to e.g. the TOE running a management application on a web server that allows for remote access to the TSF without separately accessing the underlying platform). The data passed in this trusted 
              communication channel are encrypted as defined in the protocol chosen in the first selection. The ST 
              author chooses the mechanism or mechanisms supported by the TOE.<h:br/><h:br/>
              If "IPsec as defined in the PP-Module for VPN Client" is selected, the TSF must claim conformance to a PP-Configuration that includes the VPN Client PP-Module.<h:br/><h:br/>              
              If the ST author selects "SSH as defined in the Functional Package for Secure Shell," the TSF must be validated against the FP for Secure Shell with the MDM PP. It should be noted that due to constraints imposed by this PP that SHA-1 cannot be used.<h:br/><h:br/>
              If the ST author selects "TLS as defined in the Package for Transport Layer Security" the TSF must be validated against requirements from the Package for Transport Layer Security, with the following selections made:
              <h:ul>
                <h:li>FCS_TLS_EXT.1: 
                  <h:ul>
                    <h:li>TLS must be selected</h:li>
                    <h:li>Server must be selected</h:li>
                  </h:ul>
                </h:li>
                <h:li>FCS_TLSS_EXT.1.1:
                  <h:ul>
                    <h:li>The cipher suites selected must correspond with the algorithms and hash functions allowed in FCS_COP.1.</h:li>
                  </h:ul>
                </h:li>
              </h:ul>
              Protocol, RBG, Certificate validation, algorithm, and similar services may be met with
              platform-provided services. <h:br/><h:br/>
              If HTTPS is chosen, FCS_HTTPS_EXT.1 must be included in the ST.
            </note>
            <aactivity>
              <no-tests/>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation and termination of the trusted channel</audit-event-descr>
            <audit-event-info>Trusted channel protocol</audit-event-info>
            <audit-event-info>Identity of administrator</audit-event-info>
          </audit-event>
        </f-component>
        
        
      </section>
      
      
      
  	</man-sfrs>
    
    <opt-sfrs></opt-sfrs>
    <sel-sfrs>
      
      <section id="sel-fau" title="Security Audit (FAU)">
        
        <f-component cc-id="fau_sar.1" name="Audit Review">
          <depends  on-sel="locally"/>
          <f-element id="fau-sar-1e1">
            <title><comment>ESR: auditing and compliance<h:br/>
              Adapted from MDM PP requirement of the same name<h:br/></comment>
              The TSF shall <selectables>
              <selectable><h:b>invoke platform-provided functionality</h:b></selectable>
              <selectable><h:b>implement functionality</h:b></selectable>
            </selectables> <h:b>to</h:b> provide [<h:i>authorized administrators</h:i>] with the
              capability to read [<h:i>all audit information</h:i>] from the audit data.</title>            
          </f-element>
          
          <f-element id="fau-sar-1e2">
            
              <title>The TSF shall <selectables>
              <selectable><h:b>invoke platform-provided functionality</h:b></selectable>
              <selectable><h:b>implement functionality</h:b></selectable>
            </selectables> <h:b>to</h:b> provide the audit data in a manner suitable for the
              <h:b>authorized administrators</h:b> to interpret the information.</title>
            <note role="application">The intent of this requirement is to ensure that the
              administrator can view and interpret the audit data and to
              prevent unauthorized users from accessing the logs.</note>
            <aactivity>
            <no-tests/>
            </aactivity>
          </f-element>
          <audit-event/>
        </f-component> 
        
        
      <f-component cc-id="fau_stg.2" name="Audit Event Storage">
        <depends  on-sel="locally"/>
        
        <f-element id="fel-stg-func">
          <title><comment>ESR: auditing and compliance<h:br/>
            Adapted from MDM PP requirement of the same name<h:br/></comment>
            The TSF shall <selectables>
            <selectable><h:b>invoke platform-provided functionality</h:b></selectable>
            <selectable><h:b>implement functionality</h:b></selectable>
          </selectables> to protect the stored audit data in the audit trail from unauthorized
            <h:b>modification</h:b>.</title>
          <note role="application">If "store audit data locally" is selected in <xref
            to="fau-stg-1e1"/>, this SFR must be included in the ST.<h:br/><h:br/> 
            The purpose of this requirement is to ensure that audit data are stored securely. The ST author
            is responsible for selecting whether audit data 
            are maintained when audit storage or failure occurs. The ST author must choose a means by which
            audit data are saved and select the events during which
            the data will be saved. The TSF may rely on the underlying operating system for this functionality, and the first selection should be made
            appropriately. 
          </note>
        </f-element>
        <f-element>
          <title>The TSF shall be able to <selectables onlyone="yes">
            <selectable>prevent</selectable>
            <selectable>detect</selectable>
          </selectables>
            unauthorized modifications to the stored audit data in the audit trail.</title>
          <aactivity>
            <no-tests/>
          </aactivity>
        </f-element>
        <audit-event/>
      </f-component>
      </section>
      
      
      <section id="impl-dep-ftp" title="Trusted Path/Channels (FTP)">
        
        <f-component cc-id="ftp_trp.1" name="Trusted Path (for Joining)" iteration="Join">
          <depends on-sel="joiningchannel"/>
          <f-element id="ftp-trp-1e1-tj">
            <title><comment>ESR: Resiliency<h:br/>
              Adapted from MDM PP requirement of the same name<h:br/></comment>
              The TSF shall <selectables>
              <selectable><h:b>invoke platform-provided functionality</h:b></selectable>
              <selectable><h:b>implement functionality</h:b></selectable>
            </selectables> <h:b>to</h:b> provide a communication path between itself and <h:b>a joining
              component</h:b> that is logically distinct from other communication paths and provides assured identification of <selectables>
                <selectable><h:b>the TSF endpoint</h:b></selectable>
                <selectable><h:b>both joining component and TSF endpoint</h:b></selectable>
              </selectables> and protection of the communicated data from
              [<h:i>modification</h:i>] <h:b>and</h:b> <selectables>
                <selectable>disclosure</selectable>
                <selectable><h:b>none</h:b></selectable>
              </selectables>.</title>
          </f-element>
          
          <f-element id="ftp-trp-1e2-tj">
            <title>The TSF shall <selectables>
              <selectable><h:b>invoke platform-provided functionality</h:b></selectable>
              <selectable><h:b>implement functionality</h:b></selectable>
            </selectables> <h:b>to</h:b> permit <selectables>
              <selectable>the TSF</selectable>
              <selectable><h:b>the joining component</h:b></selectable>
            </selectables> to initiate communication via the trusted path.</title>
          </f-element>
          
          <f-element id="fel-trp-func-tsf"> 
            <title>The TSF shall <selectables>
              <selectable><h:b>invoke platform-provided functionality</h:b></selectable>
              <selectable><h:b>implement functionality</h:b></selectable>
            </selectables> <h:b>to</h:b> require the use of the trusted path for [<h:i>joining components
              to the TSF under environmental constraints identified in <assignable>reference to operational guidance</assignable>]</h:i>.</title>
            <note role="application">This SFR implements one of the types of channel identified in the main selection for <xref to="fel-cpc-func"/>. The "joining component" in FTP_TRP.1/Join is the IT entity that is attempting to join the distributed TOE by using the registration process.<h:br/><h:br/>            
              The effect of this SFR is to require the ability for components to communicate in a secure manner while the distributed TSF is being created (or when adding components to an existing distributed TSF). When creating the TSF from the initial pair of components, either of these components may be identified as the TSF for the purposes of satisfying the meaning of "TSF" in this SFR.<h:br/><h:br/>
              The selection at the end of FTP_TRP.1/Join recognises that in some cases confidentiality (i.e., protection of the data from disclosure) may not be provided by the channel. The ST author distinguishes in the TSS whether in this case the TOE relies on the environment to provide confidentiality (as part of the constraints referenced in <xref to="fel-trp-func-tsf"/>) or whether the registration data exchanged does not require confidentiality (in which case this assertion must be justified). If "none" is selected, then this word may be omitted in the ST to improve readability.<h:br/><h:br/>             
              The assignment in <xref to="fel-trp-func-tsf"/> ensures that the ST highlights any specific details needed to protect the registration environment. Note that when the ST uses FTP_TRP.1/TRUSTPATH_JOIN for the registration channel then this channel cannot be reused as the normal inter-component communication channel defined in FPT_ITT.1.<h:br/><h:br/>
              
            </note>
            <aactivity>
          <no-tests/>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Initiation and termination of the trusted channel</audit-event-descr>
            <audit-event-info>Trusted channel protocol</audit-event-info>
          </audit-event>
        </f-component>
        
      </section>
      
    </sel-sfrs>
    <obj-sfrs></obj-sfrs>
    <impl-dep-sfrs>
      
      <section id="impl-dep-fco" title="Communications (FCO)">
        
        <ext-comp-def title="Component Registration Channel Definition" fam-id="FCO_CPC_EXT">
          <fam-behavior>This family describes the registration process, including the capability for
            the administrator to enable or disable communications between a distributed TOE and other
            components of the TOE.</fam-behavior>
        </ext-comp-def>
        
        <f-component cc-id="fco_cpc_ext.1" name="Component Registration Channel Definition">
          <depends on="distributed"/>
          <consistency-rationale/>
          <comp-lev>defines requirements for the registration process for distributed TOEs.</comp-lev>
          <management>There are no management activities foreseen.</management>
          <audit>The following actions should be auditable if FAU_GEN security audit data generation
            is included in the PP or ST.
            <h:ul>
              <h:li>Enabling or disabling communications between a pair of components.</h:li>
              <h:li>Identities of the endpoint's pairs enabled or disabled.</h:li>
            </h:ul>
          </audit>
          <dependencies>
            <no-link>FPT_ITT.1</no-link> TSF Data Transfer<h:br/>
            <no-link>FTP_TRP.1</no-link> Trusted Path
          </dependencies>
          
          <f-element id="fel-cpc">
            <title><comment>ESR: Resiliency<h:br/>
                Adapted from MDM PP requirement of the same name<h:br/></comment>
              The TSF shall <selectables>
              <selectable>invoke platform-provided functionality</selectable>
              <selectable>implement functionality</selectable>
            </selectables> to require an Administrator to enable communications between any pair of TOE components before such communication can take place.
            </title>
            
          </f-element>
          <f-element id="fel-cpc-func">
            <title>The TSF shall <selectables>
              <selectable>invoke platform-provided functionality</selectable>
              <selectable>implement functionality</selectable>
            </selectables> to implement a registration process in which components establish and use a communications channel that uses
              <selectables>
                <selectable>A channel that meets the secure channel requirements in FPT_ITT.1
                </selectable>
                <selectable id="joiningchannel">A channel that meets the secure registration channel requirements in FTP_TRP.1/Join</selectable>
                <selectable>No channel</selectable>
              </selectables>
              for at least TSF data.
            </title>
          </f-element>
          
          <f-element id="fel-cpc-disablecomms">
            <title>The TSF shall <selectables>
              <selectable>invoke platform-provided functionality</selectable>
              <selectable>implement functionality</selectable>
            </selectables> to enable an administrator to disable communications between any pair of TOE components.</title>
            <note role="application">
              This SFR is only applicable if the TOE is distributed and therefore has multiple components that need to communicate via an internal 
              TSF channel. When creating the TSF from the initial pair of components, either of these components may be identified as the 
              TSF for the purposes of satisfying the meaning of "TSF" in this SFR.<h:br/><h:br/>
              
             Registration of the distributed TOE components may be accomplished either using the same trusted channel that subsequent communications occur on (FPT_ITT.1), a separate channel that exists for the purpose of facilitaing this registration, i.e. a joining channel (FTP_TRP.1/Join), or no channel. In the case of the latter, registration would be accomplished by independent administrative configuration of each component. </note>
            <aactivity>
            <no-tests/>
            </aactivity>
          </f-element>
          <audit-event>
            <audit-event-descr>Enabling or disabling communications between a pair of components.</audit-event-descr>
            <audit-event-info>Identities of the endpoint's pairs enabled or disabled.</audit-event-info>
          </audit-event>
        </f-component>       
        
      </section>
      
      <section id="impl-dep-fpt" title="Protection of the TSF (FPT)">
      <f-component cc-id="fpt_itt.1" name="Internal TOE TSF Data Transfer">
        <depends on="distributed"/>
        <f-element id="fel-interxfer">
          <title><comment>ESR: Resiliency<h:br/>
            Adapted from MDM PP requirement of the same name<h:br/></comment>
            The TSF shall <selectables linebreak="yes">
            <selectable><h:b>invoke platform-provided functionality to use <selectables linebreak="yes">
              <selectable id="ITT1_IPSEC_INVOKE">IPsec</selectable>
              <selectable id="ITT1_TLS_INVOKE">mutually authenticated TLS</selectable>
              <selectable id="ITT1_DTLS_INVOKE">mutually authenticated DTLS</selectable>
              <selectable id="ITT1_HTTPS_INVOKE">HTTPS</selectable>
              <selectable id="ITT1_SSH_INVOKE">SSH</selectable>
            </selectables></h:b></selectable>
            <selectable><h:b>implement functionality using <selectables linebreak="yes">
              <selectable id="ITT1_IPSEC_IMPLEMENT">IPsec as defined in the PP-Module for VPN Client</selectable>
              <selectable id="ITT1_TLS_IMPLEMENT">mutually authenticated TLS as defined in the Package for Transport Layer Security</selectable>
              <selectable id="ITT1_DTLS_IMPLEMENT">mutually authenticated DTLS as defined in the Package for Transport Layer Security</selectable>
              <selectable id="ITT1_HTTPS_IMPLEMENT">HTTPS in accordance with FCS_HTTPS_EXT.1 as defined in the Base-PP</selectable>
              <selectable id="ITT1_SSH_IMPLEMENT">SSH as defined in the Functional Package for Secure Shell</selectable>
            </selectables></h:b></selectable></selectables> <h:b>to</h:b> protect <h:b>all</h:b> data from [<h:i>disclosure and modification</h:i>] when it is <h:b>transferred</h:b> between
            separate parts of the TOE.</title>
          <note role="application">This requirement ensures all communications between components of a distributed TOE are protected through the use of an encrypted communications channel. The data passed in this trusted communication channel are encrypted as defined in the protocol chosen in the second selection.<h:br/><h:br/>              
            If "IPsec as defined in the PP-Module for VPN Client" is selected, the TSF must claim conformance to a PP-Configuration that includes the VPN Client PP-Module.<h:br/><h:br/>
            If the ST author selects "SSH as defined in the Functional Package for Secure Shell," the TSF must be validated against the FP for Secure Shell. It should be noted that due to constraints imposed by this PP that SHA-1 cannot be used.<h:br/><h:br/>
            If the ST author selects "mutually authenticated TLS as defined in the Package for Transport Layer Security" or "mutually authenticated DTLS as defined in the Package for Transport Layer Security," the TSF must be validated against requirements from the Package for Transport Layer Security, with the following selections made:
            <h:ul>
              <h:li>FCS_TLS_EXT.1: 
                <h:ul>
                  <h:li>either TLS or DTLS is selected depending on the selection made in </h:li>
                  <h:li>either client or server is selected as appropriate</h:li>
                </h:ul>
              </h:li>
              <h:li>FCS_TLSC_EXT.1.1 or FCS_TLSS_EXT.1.1 (as appropriate):
                <h:ul>
                  <h:li>The cipher suites selected must correspond with the algorithms and hash functions allowed in FCS_COP.1.</h:li>
                  <h:li>mutual authentication must be selected</h:li>
                </h:ul>
              </h:li>
            </h:ul>
            Protocol, RBG, Certificate validation, algorithm, and similar services may be met with
            platform-provided services. <h:br/><h:br/>
            This requirement is claimed if "FPT_ITT.1/INTER_XFER" is selected in FTP_ITC_EXT.1.

          </note>
          <aactivity>
            <TSS>The evaluator shall examine the TSS to determine that the
              methods and protocols used to protect distributed TOE components
              are described. The evaluator shall also confirm that all protocols listed in the
              TSS in support of TOE administration are
              consistent with those specified in the requirement, and are included in the
              requirements in the ST.<h:br/><h:br/>
              If "invoke platform-provided functionality" is selected, the evaluator shall examine the TSS to verify that it describes (for each supported platform) how this functionality is invoked (it should be noted that this may be through a mechanism that is not implemented by the TOE; nonetheless, that mechanism will be identified in the TSS as part of this evaluation activity).</TSS>
            <Guidance>The evaluator shall confirm that the operational guidance contains
              instructions for establishing the communication paths for each supported
              method.</Guidance>
            <Tests>
              <testlist>
                <test>The evaluator shall ensure that communications using each specified (in the
                  operational guidance) communication method is tested during the course of the
                  evaluation, setting up the connections as described in the operational guidance
                  and ensuring that communication is successful.</test>
                <test>The evaluator shall ensure, for each method of communication, the channel
                  data is not sent in plaintext.</test>
              </testlist> Further evaluation activities are associated with the specific protocols.
            </Tests>
          </aactivity>
        </f-element>
        <audit-event>
          <audit-event-descr>Initiation and termination of the trusted channel</audit-event-descr>
          <audit-event-info>Trusted channel protocol</audit-event-info>
          <audit-event-info>Identity of initiator and recipient</audit-event-info>
        </audit-event>
      </f-component>
      
      </section>
    
      
    </impl-dep-sfrs>
  </section>
  <!-- 
       Do NOT put SFRs in this section. All SFR belong up above in SFR section. 
       To make an SFR optional tag it above as status="optional" 
  -->
  <appendix title="Optional Requirements" id="optional"> As indicated in <xref to="ccl"/>,
    the baseline requirements (those that must be performed by the OS) are
    contained in the body of this PP. Additionally, there are three other types of requirements
    specified in <xref to="optional"/>, <xref to="sel-based"/>, and <xref to="objective"/>.
    The first type (in this Appendix) are requirements that can be included
    in the ST, but are not required in order for a OS to claim conformance to
    this PP. The second type (in <xref to="sel-based"/>) are requirements based on selections
    in the body of the PP: if certain selections are made, then additional requirements in that
    appendix must be included. The third type (in <xref to="objective"/> are components that
    are not required in order to conform to this PP, but will be included in the baseline
    requirements in future versions of this PP, so adoption by vendors is encouraged. Note that the
    ST author is responsible for ensuring that requirements that may be associated with those in
      <xref to="optional"/>, <xref to="sel-based"/>, and <xref to="objective"/>
    but are not listed (e.g., FMT-type requirements) are also included in the ST. </appendix>

  <!-- 
       Do NOT put SFRs in this section. All SFR belong up above in SFR section. 
       To make an SFR optional tag it above as status="sel-based" 
  -->
  <appendix title="Selection-Based Requirements" id="sel-based"> As indicated in the introduction to
    this PP, the baseline requirements (those that must be performed by the OS or its underlying
    platform) are contained in the body of this PP. There are additional requirements based on
    selections in the body of the PP: if certain selections are made, then additional requirements
    below will need to be included. </appendix>

  <!-- 
       Do NOT put SFRs in this section. All SFR belong up above in SFR section. 
       To make an SFR optional tag it above as /"objective" 
  -->
  <appendix title="Objective Requirements" id="objective"> This appendix includes requirements that
    specify security functionality which also addresses threats. The requirements are not currently
    mandated in the body of this PP as they describe security functionality not yet widely-available
    in commercial technology. However, these requirements may be included in the ST such that the
    OS is still conformant to this PP, and it is expected that they be included as soon as
    possible. </appendix>

  <appendix title="Inherently Satisfied Requirements" id="satisfiedreqs"> This
	appendix lists requirements that should be considered satisfied by products
	successfully evaluated against this Protection Profile.  
	However, these requirements are not featured explicitly as SFRs and should not be
	included in the ST.  
	They are not included as standalone SFRs because it would
	increase the time, cost, and complexity of evaluation.  This approach is permitted
	by <xref g="CC"/> Part 1, <h:b>8.2 Dependencies between components</h:b>.
    <h:br/>
	This information benefits systems engineering activities which call for inclusion of 
	particular security controls.  Evaluation against the Protection Profile
	provides evidence that these controls are present and have been evaluated.


  </appendix>


  <!-- Remove this section if an Entropy Assessment is not needed -->
  <bibliography>
    <cc-entry/>
    <entry id="bibAppPP">
      <tag>AppPP</tag>
      <description>
        <h:a href="https://www.niap-ccevs.org/protectionprofiles/516"
          >Protection Profile for Application Software, Version 2.0, June 16, 2025</h:a>
      </description>
    </entry>
    
  </bibliography>

</Module>

